<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.3 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Cache Reverse Proxy - nginx - Wayneâ€™s Geek Life</title>
<meta name="description" content="IntroductionOn the homepage of nxing wiki, there used to be one sentence which really impressed my very much when I first time to take a look at it and learn it three years ago:Apache is like Microsoft Word, it has a million options but you only need six. Nginx does those six things, and it does five of them 50 times faster than Apache. &nbsp;--Chris LeaNow it is not there anymore, how you can still search on the web to see it:&nbsp;example link.One of the six things nginx can do and can do gorgeous is putting it in front of the web application server as a Cache Reverse Proxy, which does two major tasks:Receive all the requests and dispatch them to the backed server(s)Cache requests &amp; response to speed up HTTP transaction significantlyPlay a role as a load balancer (optional).What are the benefits of doing this? There are many, items below are copied from Wikepedia:Reverse proxies can hide the existence and characteristics of the origin server(s).Application firewall&nbsp;features can protect against common web-based attacks. Without a reverse proxy, removing malware or initiating takedowns, for example, can become difficult.In the case of&nbsp;secure websites, the&nbsp;SSL&nbsp;encryption&nbsp;is sometimes not performed by the web server itself, but is instead offloaded to a reverse proxy that may be equipped with&nbsp;SSL accelerationhardware. (See&nbsp;SSL termination proxy)A reverse proxy can&nbsp;distribute the load&nbsp;from incoming requests to several servers, with each server serving its own application area. In the case of reverse proxying in the neighborhood of&nbsp;web servers, the reverse proxy may have to rewrite the&nbsp;URL&nbsp;in each incoming request in order to match the relevant internal location of the requested resource.A reverse proxy can reduce load on its origin servers by&nbsp;caching&nbsp;static content, as well as&nbsp;dynamic content. Proxy caches of this sort can often satisfy a considerable amount of website requests, greatly reducing the load on the origin server(s). Another term for this is&nbsp;web accelerator.A reverse proxy can optimize content by&nbsp;compressing&nbsp;it in order to speed up loading times.In a technique known as &quot;spoon feeding&quot;,[2]&nbsp;a dynamically generated page can be produced all at once and served to the reverse-proxy, which can then return it to the client a little bit at a time. The program that generates the page is not forced to remain open and tying up server resources during the possibly extended time the client requires to complete the transfer.Reverse proxies can be used whenever multiple web servers must be accessible via a single public IP address. The web servers listen on different ports in the same machine, with the same local IP address or, possibly, on different machines and different local IP addresses altogether. The reverse proxy analyzes each incoming call and delivers it to the right server within the local area network.Reverse proxies can be used to perform&nbsp;A/B testing&nbsp;and&nbsp;Multivariate testing&nbsp;without placing javascript tags or code into pages.&nbsp;This post is focused on No 1 and 2 with dynamica content from backend web server, No 3 is simple enough, nginx provides a HTTP UPSTREAM module for doing it.The scenarioImage there is a web resource which is frequenyly accessed, and is less frequently updated, but it does cares aboutinstantaneity, for example:A relatively static homepage with high concurrent requests.A wiki page shared within an enterprise.For this kind of scenario, our idea scenario is:Nginx can cache the resource, and it will refresh the cache as soon as the resource got updated, so that all the further requests will retrieve the latest version!How to do itI built up a Rails 3, it expose a resource:&nbsp;http://localhost:3000/doc,&nbsp;it is very simple, each time a GET request comes in, it read a JSON file stored on hard disk:{ &nbsp; &quot;Counter&quot;: 1}And each time a POST request comes in, it update the Counter to plus one.The routes.rb:">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Wayne's Geek Life">
<meta property="og:title" content="Cache Reverse Proxy - nginx">
<meta property="og:url" content="http://localhost:4000/Cache-Reverse-Proxy-nginx">


  <meta property="og:description" content="IntroductionOn the homepage of nxing wiki, there used to be one sentence which really impressed my very much when I first time to take a look at it and learn it three years ago:Apache is like Microsoft Word, it has a million options but you only need six. Nginx does those six things, and it does five of them 50 times faster than Apache. &nbsp;--Chris LeaNow it is not there anymore, how you can still search on the web to see it:&nbsp;example link.One of the six things nginx can do and can do gorgeous is putting it in front of the web application server as a Cache Reverse Proxy, which does two major tasks:Receive all the requests and dispatch them to the backed server(s)Cache requests &amp; response to speed up HTTP transaction significantlyPlay a role as a load balancer (optional).What are the benefits of doing this? There are many, items below are copied from Wikepedia:Reverse proxies can hide the existence and characteristics of the origin server(s).Application firewall&nbsp;features can protect against common web-based attacks. Without a reverse proxy, removing malware or initiating takedowns, for example, can become difficult.In the case of&nbsp;secure websites, the&nbsp;SSL&nbsp;encryption&nbsp;is sometimes not performed by the web server itself, but is instead offloaded to a reverse proxy that may be equipped with&nbsp;SSL accelerationhardware. (See&nbsp;SSL termination proxy)A reverse proxy can&nbsp;distribute the load&nbsp;from incoming requests to several servers, with each server serving its own application area. In the case of reverse proxying in the neighborhood of&nbsp;web servers, the reverse proxy may have to rewrite the&nbsp;URL&nbsp;in each incoming request in order to match the relevant internal location of the requested resource.A reverse proxy can reduce load on its origin servers by&nbsp;caching&nbsp;static content, as well as&nbsp;dynamic content. Proxy caches of this sort can often satisfy a considerable amount of website requests, greatly reducing the load on the origin server(s). Another term for this is&nbsp;web accelerator.A reverse proxy can optimize content by&nbsp;compressing&nbsp;it in order to speed up loading times.In a technique known as &quot;spoon feeding&quot;,[2]&nbsp;a dynamically generated page can be produced all at once and served to the reverse-proxy, which can then return it to the client a little bit at a time. The program that generates the page is not forced to remain open and tying up server resources during the possibly extended time the client requires to complete the transfer.Reverse proxies can be used whenever multiple web servers must be accessible via a single public IP address. The web servers listen on different ports in the same machine, with the same local IP address or, possibly, on different machines and different local IP addresses altogether. The reverse proxy analyzes each incoming call and delivers it to the right server within the local area network.Reverse proxies can be used to perform&nbsp;A/B testing&nbsp;and&nbsp;Multivariate testing&nbsp;without placing javascript tags or code into pages.&nbsp;This post is focused on No 1 and 2 with dynamica content from backend web server, No 3 is simple enough, nginx provides a HTTP UPSTREAM module for doing it.The scenarioImage there is a web resource which is frequenyly accessed, and is less frequently updated, but it does cares aboutinstantaneity, for example:A relatively static homepage with high concurrent requests.A wiki page shared within an enterprise.For this kind of scenario, our idea scenario is:Nginx can cache the resource, and it will refresh the cache as soon as the resource got updated, so that all the further requests will retrieve the latest version!How to do itI built up a Rails 3, it expose a resource:&nbsp;http://localhost:3000/doc,&nbsp;it is very simple, each time a GET request comes in, it read a JSON file stored on hard disk:{ &nbsp; &quot;Counter&quot;: 1}And each time a POST request comes in, it update the Counter to plus one.The routes.rb:">







  <meta property="article:published_time" content="2013-01-10T00:00:00-08:00">





  

  
    <meta property="fb:app_id" content="374223339969060">
  


<link rel="canonical" href="http://localhost:4000/Cache-Reverse-Proxy-nginx">













<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Wayne's Geek Life Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">Wayne's Geek Life</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/search/" >Search</a>
            </li><li class="masthead__menu-item">
              <a href="/album/" >Album</a>
            </li><li class="masthead__menu-item">
              <a href="/about" >About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/me.jpg" alt="Wayne Ye" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Wayne Ye</h3>
    
    
      <p class="author__bio" itemprop="description">
        Whatever is worth doing is worth doing well!
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">San Francisco</span>
        </li>
      

      
        
          
            <li><a href="mailto:me@wayneye.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
          
        
          
            <li><a href="https://wayneye.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Website</a></li>
          
        
          
            <li><a href="https://twitter.com/wayneye" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
          
        
          
            <li><a href="https://facebook.com/WayneYeDotCom" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
          
        
          
            <li><a href="https://github.com/WayneYe/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Cache Reverse Proxy - nginx">
    <meta itemprop="description" content="IntroductionOn the homepage of nxing wiki, there used to be one sentence which really impressed my very much when I first time to take a look at it and learn it three years ago:Apache is like Microsoft Word, it has a million options but you only need six. Nginx does those six things, and it does five of them 50 times faster than Apache. &nbsp;--Chris LeaNow it is not there anymore, how you can still search on the web to see it:&nbsp;example link.One of the six things nginx can do and can do gorgeous is putting it in front of the web application server as a Cache Reverse Proxy, which does two major tasks:Receive all the requests and dispatch them to the backed server(s)Cache requests &amp; response to speed up HTTP transaction significantlyPlay a role as a load balancer (optional).What are the benefits of doing this? There are many, items below are copied from Wikepedia:Reverse proxies can hide the existence and characteristics of the origin server(s).Application firewall&nbsp;features can protect against common web-based attacks. Without a reverse proxy, removing malware or initiating takedowns, for example, can become difficult.In the case of&nbsp;secure websites, the&nbsp;SSL&nbsp;encryption&nbsp;is sometimes not performed by the web server itself, but is instead offloaded to a reverse proxy that may be equipped with&nbsp;SSL accelerationhardware. (See&nbsp;SSL termination proxy)A reverse proxy can&nbsp;distribute the load&nbsp;from incoming requests to several servers, with each server serving its own application area. In the case of reverse proxying in the neighborhood of&nbsp;web servers, the reverse proxy may have to rewrite the&nbsp;URL&nbsp;in each incoming request in order to match the relevant internal location of the requested resource.A reverse proxy can reduce load on its origin servers by&nbsp;caching&nbsp;static content, as well as&nbsp;dynamic content. Proxy caches of this sort can often satisfy a considerable amount of website requests, greatly reducing the load on the origin server(s). Another term for this is&nbsp;web accelerator.A reverse proxy can optimize content by&nbsp;compressing&nbsp;it in order to speed up loading times.In a technique known as &quot;spoon feeding&quot;,[2]&nbsp;a dynamically generated page can be produced all at once and served to the reverse-proxy, which can then return it to the client a little bit at a time. The program that generates the page is not forced to remain open and tying up server resources during the possibly extended time the client requires to complete the transfer.Reverse proxies can be used whenever multiple web servers must be accessible via a single public IP address. The web servers listen on different ports in the same machine, with the same local IP address or, possibly, on different machines and different local IP addresses altogether. The reverse proxy analyzes each incoming call and delivers it to the right server within the local area network.Reverse proxies can be used to perform&nbsp;A/B testing&nbsp;and&nbsp;Multivariate testing&nbsp;without placing javascript tags or code into pages.&nbsp;This post is focused on No 1 and 2 with dynamica content from backend web server, No 3 is simple enough, nginx provides a HTTP UPSTREAM module for doing it.The scenarioImage there is a web resource which is frequenyly accessed, and is less frequently updated, but it does cares aboutinstantaneity, for example:A relatively static homepage with high concurrent requests.A wiki page shared within an enterprise.For this kind of scenario, our idea scenario is:Nginx can cache the resource, and it will refresh the cache as soon as the resource got updated, so that all the further requests will retrieve the latest version!How to do itI built up a Rails 3, it expose a resource:&nbsp;http://localhost:3000/doc,&nbsp;it is very simple, each time a GET request comes in, it read a JSON file stored on hard disk:{ &nbsp; &quot;Counter&quot;: 1}And each time a POST request comes in, it update the Counter to plus one.The routes.rb:">
    <meta itemprop="datePublished" content="January 10, 2013">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Cache Reverse Proxy - nginx
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  6 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-cog"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#">Introduction</a></li>
  <li><a href="#">The scenario</a></li>
  <li><a href="#">How to do it</a></li>
  <li><a href="#">Conclusion</a></li>
  <li><a href="#">References</a></li>
</ul>
            </nav>
          </aside>
        
        <h2>Introduction</h2>
<p>On the homepage of <a title="nginx Wiki" href="wiki.nginx.org/Main" target="_blank">nxing wiki</a>, there used to be one sentence which really impressed my very much when I first time to take a look at it and learn it three years ago:</p>
<blockquote>
<p>Apache is like Microsoft Word, it has a million options but you only need six. Nginx does those six things, and it does five of them 50 times faster than Apache. &nbsp;--<a href="https://chrislea.com/" target="_blank">Chris Lea</a></p>
<!--more-->
</blockquote>
<p>Now it is not there anymore, how you can still search on the web to see it:&nbsp;<a href="http://www.wikivs.com/wiki/Apache_vs_nginx" target="_blank">example link</a>.</p>
<p>One of the six things nginx can do and c<strong>an do gorgeous</strong> is putting it in front of the web application server as a <a title="http://en.wikipedia.org/wiki/Reverse_proxy" href="http://en.wikipedia.org/wiki/Reverse_proxy"><strong>Cache Reverse Proxy</strong></a>, which does two major tasks:</p>
<ol>
<li><strong>Receive all the requests and dispatch them to the backed server(s)</strong></li>
<li><strong>Cache requests &amp; response to speed up HTTP transaction significantly</strong></li>
<li>Play a role as a load balancer (optional).</li>
</ol>
<p>What are the benefits of doing this? There are many, items below are copied from Wikepedia:</p>
<blockquote>
<ul>
<li>Reverse proxies can hide the existence and characteristics of the origin server(s).</li>
<li><a title="Application firewall" href="http://en.wikipedia.org/wiki/Application_firewall">Application firewall</a>&nbsp;features can protect against common web-based attacks. Without a reverse proxy, removing malware or initiating takedowns, for example, can become difficult.</li>
<li>In the case of&nbsp;<a class="mw-redirect" title="Secure website" href="http://en.wikipedia.org/wiki/Secure_website">secure websites</a>, the&nbsp;<a class="mw-redirect" title="Secure Sockets Layer" href="http://en.wikipedia.org/wiki/Secure_Sockets_Layer">SSL</a>&nbsp;<a title="Encryption" href="http://en.wikipedia.org/wiki/Encryption">encryption</a>&nbsp;is sometimes not performed by the web server itself, but is instead offloaded to a reverse proxy that may be equipped with&nbsp;<a title="SSL acceleration" href="http://en.wikipedia.org/wiki/SSL_acceleration">SSL acceleration</a>hardware. (See&nbsp;<a title="SSL termination proxy" href="http://en.wikipedia.org/wiki/SSL_termination_proxy">SSL termination proxy</a>)</li>
<li>A reverse proxy can&nbsp;<a class="mw-redirect" title="Load balancer" href="http://en.wikipedia.org/wiki/Load_balancer">distribute the load</a>&nbsp;from incoming requests to several servers, with each server serving its own application area. In the case of reverse proxying in the neighborhood of&nbsp;<a title="Web server" href="http://en.wikipedia.org/wiki/Web_server">web servers</a>, the reverse proxy may have to rewrite the&nbsp;<a class="mw-redirect" title="URL" href="http://en.wikipedia.org/wiki/URL">URL</a>&nbsp;in each incoming request in order to match the relevant internal location of the requested resource.</li>
<li>A reverse proxy can reduce load on its origin servers by&nbsp;<a title="Web cache" href="http://en.wikipedia.org/wiki/Web_cache">caching</a>&nbsp;<a title="Static web page" href="http://en.wikipedia.org/wiki/Static_web_page">static content</a>, as well as&nbsp;<a title="Dynamic web page" href="http://en.wikipedia.org/wiki/Dynamic_web_page">dynamic content</a>. Proxy caches of this sort can often satisfy a considerable amount of website requests, greatly reducing the load on the origin server(s). Another term for this is&nbsp;<a title="Web accelerator" href="http://en.wikipedia.org/wiki/Web_accelerator">web accelerator</a>.</li>
<li>A reverse proxy can optimize content by&nbsp;<a title="Data compression" href="http://en.wikipedia.org/wiki/Data_compression">compressing</a>&nbsp;it in order to speed up loading times.</li>
<li>In a technique known as "spoon feeding",<sup id="cite_ref-spoon-feeding_2-0" class="reference"><a href="http://en.wikipedia.org/wiki/Reverse_proxy#cite_note-spoon-feeding-2">[2]</a></sup>&nbsp;a dynamically generated page can be produced all at once and served to the reverse-proxy, which can then return it to the client a little bit at a time. The program that generates the page is not forced to remain open and tying up server resources during the possibly extended time the client requires to complete the transfer.</li>
<li>Reverse proxies can be used whenever multiple web servers must be accessible via a single public IP address. The web servers listen on different ports in the same machine, with the same local IP address or, possibly, on different machines and different local IP addresses altogether. The reverse proxy analyzes each incoming call and delivers it to the right server within the local area network.</li>
<li>Reverse proxies can be used to perform&nbsp;<a title="A/B testing" href="http://en.wikipedia.org/wiki/A/B_testing">A/B testing</a>&nbsp;and&nbsp;<a title="Multivariate testing" href="http://en.wikipedia.org/wiki/Multivariate_testing">Multivariate testing</a>&nbsp;without placing javascript tags or code into pages.</li>
</ul>
</blockquote>
<p>&nbsp;</p>
<p>This post is focused on No 1 and 2 with dynamica content from backend web server, No 3 is simple enough, nginx provides a <a title="HttpUpstreamModule" href="http://wiki.nginx.org/HttpUpstreamModule">HTTP UPSTREAM</a> module for doing it.</p>
<h2>The scenario</h2>
<p>Image there is a web resource which <strong>is frequenyly accessed, and is less frequently updated</strong>, but it does cares about</p>
<p class="p1"><strong>instantaneity</strong>, for example:</p>
<ol>
<li class="p1">A relatively static homepage with high concurrent requests.</li>
<li class="p1">A wiki page shared within an enterprise.</li>
</ol>
<p class="p1">For this kind of scenario, our idea scenario is:</p>
<p>Nginx can cache the resource, and it will <strong>refresh the cache</strong> as soon as the resource got updated, so that all the further requests will <strong>retrieve the latest version</strong>!</p>
<h2>How to do it</h2>
<p>I built up a Rails 3, it expose a resource:&nbsp;<a href="http://localhost/doc,">http://localhost:3000/doc,</a>&nbsp;it is very simple, each time a GET request comes in, it read a JSON file stored on hard disk:</p>
<div class="source" style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: #f6f3e8; background-color: #242424;"><span style="color: #f6f3e8;">{</span><br> <span style="color: #8ac6f2;">&nbsp; "Counter"</span><span style="color: #f6f3e8;">:</span> <span style="color: #e5786d;">1</span><br><span style="color: #f6f3e8;">}</span></div>
<p>And each time a POST request comes in, it update the Counter to plus one.</p>
<p>The routes.rb:</p>

<div class="source" style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: #f6f3e8; background-color: #242424;"><span style="color: #f6f3e8;">get</span> <span style="color: #95e454; font-style: italic;">'doc'</span> <span style="color: #f6f3e8;">=&gt;</span> <span style="color: #95e454; font-style: italic;">'doc#view'</span><br><span style="color: #f6f3e8;">post</span> <span style="color: #95e454; font-style: italic;">'doc'</span> <span style="color: #f6f3e8;">=&gt;</span> <span style="color: #95e454; font-style: italic;">'doc#edit'</span></div>
<p>The view and edit actions in controller:</p>
<div class="source" style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: #f6f3e8; background-color: #242424;"><span style="color: #f6f3e8;">before_filter</span> <span style="color: #8ac6f2;">do</span> <br>&nbsp; &nbsp;<span style="color: #cae682;">@json_path</span> <span style="color: #f6f3e8;">=</span> <span style="color: #e5786d;">Rails</span><span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">root</span><span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">join</span>(<span style="color: #95e454; font-style: italic;">"public"</span><span style="color: #f6f3e8;">,</span> <span style="color: #95e454; font-style: italic;">"doc.json"</span>)<br><span style="color: #8ac6f2;">end</span><br><br><span style="color: #8ac6f2;">def</span> <span style="color: #cae682;">view</span><br>&nbsp; &nbsp;<span style="color: #f6f3e8;">response</span><span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">header</span><span style="color: #f6f3e8;">[</span><span style="color: #95e454; font-style: italic;">"Cache-Control"</span><span style="color: #f6f3e8;">]</span> <span style="color: #f6f3e8;">=</span> <span style="color: #95e454; font-style: italic;">"public"</span><br>&nbsp; &nbsp;<span style="color: #f6f3e8;">render</span> <span style="color: #95e454; font-style: italic;">:layout</span> <span style="color: #f6f3e8;">=&gt;</span> <span style="color: #8ac6f2;">false</span><br><span style="color: #8ac6f2;">end</span><br><br><span style="color: #8ac6f2;">def</span> <span style="color: #cae682;">edit</span><br>&nbsp; &nbsp;<span style="color: #f6f3e8;">increased_counter</span> <span style="color: #f6f3e8;">=</span> <span style="color: #f6f3e8;">increase_counter</span><br>&nbsp; &nbsp;<span style="color: #f6f3e8;">response</span><span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">header</span><span style="color: #f6f3e8;">[</span><span style="color: #95e454; font-style: italic;">"Cache-Control"</span><span style="color: #f6f3e8;">]</span> <span style="color: #f6f3e8;">=</span> <span style="color: #95e454; font-style: italic;">"no-cache"</span><br>&nbsp; &nbsp;<span style="color: #f6f3e8;">response</span><span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">header</span><span style="color: #f6f3e8;">[</span><span style="color: #95e454; font-style: italic;">"Expires"</span><span style="color: #f6f3e8;">]</span> <span style="color: #f6f3e8;">=</span> <span style="color: #95e454; font-style: italic;">"-1"</span><br><br>&nbsp; &nbsp;<span style="color: #f6f3e8;">render</span> <span style="color: #95e454; font-style: italic;">:text</span> <span style="color: #f6f3e8;">=&gt;</span> <span style="color: #95e454; font-style: italic;">"Successfully Updated! The updated Counter is: </span><span style="color: #95e454; font-style: italic;">#{</span><span style="color: #f6f3e8;">increased_counter</span><span style="color: #95e454; font-style: italic;">}</span><span style="color: #95e454; font-style: italic;">"</span><br><span style="color: #8ac6f2;">end</span><br><br><span style="color: #8ac6f2;">def</span> <span style="color: #cae682;">increase_counter</span><br>&nbsp; &nbsp;<span style="color: #f6f3e8;">counter</span> <span style="color: #f6f3e8;">=</span> <span style="color: #e5786d;">JSON</span><span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">load</span>(<span style="color: #cae682;">@json_path</span>)<span style="color: #f6f3e8;">[</span><span style="color: #95e454; font-style: italic;">"Counter"</span><span style="color: #f6f3e8;">]</span> <span style="color: #f6f3e8;">+</span> <span style="color: #e5786d;">1</span><br>&nbsp; &nbsp;<span style="color: #cae682;">@json_file</span> <span style="color: #f6f3e8;">=</span> <span style="color: #e5786d;">File</span><span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">open</span>(<span style="color: #cae682;">@json_path</span><span style="color: #f6f3e8;">,</span> <span style="color: #95e454; font-style: italic;">'w'</span>)<br>&nbsp; &nbsp;<span style="color: #cae682;">@json_file</span><span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">write</span><span style="color: #f6f3e8;">({</span> <span style="color: #95e454; font-style: italic;">:Counter</span> <span style="color: #f6f3e8;">=&gt;</span> <span style="color: #f6f3e8;">counter</span> <span style="color: #f6f3e8;">}</span><span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">to_json</span>)<br>&nbsp; &nbsp;<span style="color: #cae682;">@json_file</span><span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">close</span><br>&nbsp; &nbsp;<span style="color: #f6f3e8;">counter</span><br><span style="color: #8ac6f2;">end</span></div>
<br>
<p>The simple view which renders JSON :
</p><div class="source" style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: #f6f3e8; background-color: #242424;"><span style="color: #e5786d;">&lt;%=</span> <span style="color: #e5786d;">JSON</span><span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">load</span>(<span style="color: #cae682;">@json_path</span>)<span style="color: #f6f3e8;">.</span><span style="color: #f6f3e8;">to_json</span> <span style="color: #e5786d;">%&gt;</span><br><span style="color: #f6f3e8;">&lt;form action="" method="post" accept-charset="utf-8"&gt;</span><br><span style="color: #f6f3e8;">&nbsp; &lt;input type="submit" name="Edit" id="" value="Edit" /&gt;</span><br><span style="color: #f6f3e8;">&lt;/form&gt;</span></div>
<p></p>
<br>
<p>The rails server is bound to port 3000, and I am now going to config my nginx, my nginx.config is located at <code>/usr/local/etc/nginx/nginx.conf</code>:
</p><div class="source" style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: #f6f3e8; background-color: #242424;"><span style="color: #8ac6f2;">http</span> <span style="color: #f6f3e8;">{</span><br> &nbsp; <span style="color: #f6f3e8;">proxy_cache_path</span> &nbsp;<span style="color: #95e454; font-style: italic;">/var/www/cache</span> <span style="color: #95e454; font-style: italic;">levels=1:2</span> <span style="color: #95e454; font-style: italic;">keys_zone=my-cache:8m</span> <span style="color: #95e454; font-style: italic;">max_size=1000m</span> <span style="color: #95e454; font-style: italic;">inactive=600m</span>;<br> &nbsp; <span style="color: #f6f3e8;">proxy_temp_path</span> <span style="color: #95e454; font-style: italic;">/var/www/cache/tmp</span>; <br><br> &nbsp; <span style="color: #f6f3e8;">server</span> <span style="color: #f6f3e8;">{</span><br> &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">listen</span> &nbsp; &nbsp; &nbsp; <span style="color: #e5786d;">80</span>;<br> &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">server_name</span> &nbsp;<span style="color: #95e454; font-style: italic;">localhost</span>;<br><br> &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">location</span> <span style="color: #95e454; font-style: italic;">/</span> <span style="color: #f6f3e8;">{</span><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #99968b; font-style: italic;"># Reverse proxy</span><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">proxy_pass</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #95e454; font-style: italic;">http://localhost:3000</span>;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">proxy_redirect</span> <span style="color: #e5786d;">off</span>;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #99968b; font-style: italic;"># Cache</span><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">proxy_cache</span> <span style="color: #95e454; font-style: italic;">my-cache</span>;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">proxy_cache_valid</span> &nbsp;<span style="color: #e5786d;">200</span> <span style="color: #e5786d;">302</span> &nbsp;<span style="color: #e5786d;">60m</span>;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">proxy_cache_valid</span> &nbsp;<span style="color: #e5786d;">404</span> &nbsp; &nbsp; &nbsp;<span style="color: #e5786d;">1m</span>;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">proxy_cache_bypass</span> &nbsp; <span style="color: #cae682;">$http_secret_header</span>;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">add_header</span> <span style="color: #95e454; font-style: italic;">X-Cache-Status</span> <span style="color: #cae682;">$upstream_cache_status</span>;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">proxy_set_header</span> &nbsp;<span style="color: #95e454; font-style: italic;">Host</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #cae682;">$host</span>;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">proxy_set_header</span> &nbsp;<span style="color: #95e454; font-style: italic;">X-Real-IP</span> &nbsp; &nbsp; &nbsp; <span style="color: #cae682;">$remote_addr</span>;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">proxy_set_header</span> &nbsp;<span style="color: #95e454; font-style: italic;">X-Forwarded-For</span> <span style="color: #cae682;">$proxy_add_x_forwarded_for</span>;<br> &nbsp; &nbsp; &nbsp; <span style="color: #f6f3e8;">}</span><br> &nbsp; <span style="color: #f6f3e8;">}</span><br><span style="color: #f6f3e8;">}</span></div>
<p></p>
<p>The explanation is below:</p>
<ul>
<li>proxy_cache_path: path for nginx to store cached files</li>
<li>proxy_temp_path: temp path when nginx is caching files</li>
<li>proxy_pass: the backend web server location (my Rails app in this example)&nbsp;</li>
</ul>
<p>Refer more information about the nginx proxy module config on: <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html">http://nginx.org/en/docs/http/ngx_http_proxy_module.html</a></p>
<p>Now if I restart my nginx server: sudo nginx -s reload, and visit <a href="http://localhost/doc,">http://localhost/doc,</a>&nbsp;I can see the JSON with Counter equals to 1 rendered on the web page:</p>
<p><img title="JSON Counter" src="https://pgkdga.bn1.livefilestore.com/y1pQONS1BmHcJ3Sw2Q8x6bpYJz-jwZAI3J4MUc6EUNuwneB-_IWvitDL2dXfq4L2vbAVfQIygCs1otu8VRLhSHxPihMXl7HCWI5/Screen%20Shot%202013-01-10%20at%203.10.22%20PM%201.png?psid=1" alt="JSON Counter" width="419" height="179"></p>
<p>And if we cd into /var/www/cache, we can see nginx has cached the request:<br><img title="nginx cache" src="https://pgkdga.bn1.livefilestore.com/y1pOo12YN5xCLEX8XqyRB_s_b778TjeKBdwzr4H7Ao72qoHYOx_ySqH0BZbMrDIWw_H-ffAEGEA8yR8phW7cEUxQPhzKP1nA_Hi/Screen%20Shot%202013-01-10%20at%203.13.29%20PM.png?psid=1" alt="nginx cache" width="463" height="338"></p>
<p>Important notice here: nginx will honor HTTP <code>Cache-Control</code> header, i.e. if its value is set to "no-cache" or "private", nginx will NOT cache the response!</p>
<p>Now I am going to update the Counter:<br>
<img src="https://pgkdga.bn1.livefilestore.com/y1pM5mkSabyGfdvgdh4nvVwx977xic4mdZVv8G7cnv-IQ_xMP-X5cMJQA58V0kErZeTFPI2hckwbM-BE1UinUxs4dmXF7ujFlX7/Screen%20Shot%202013-01-10%20at%203.40.00%20PM.png?psid=1" alt="update counter">
</p>
<p>And when I visit http://localhost/doc again, no doubt, I will see Counter is "1" since I've let nginx to cache it.</p>
<blockquote>Important notice here: after nginx cache the resource inbound with an HTTP verb, any further request with the same HTTP verb on this resource will be responded by nginx, backend server will never got hit! </blockquote>
<p>Now comes to the key point, by default nginx will pass any HTTP POST request to the backend without looking up the cache, so I can "purge" the nginx cache for specific resource, so that next time when a new request comes in, nginx will rebuild the cache!</p>
<p>The tool for purging nginx cache is a CLI tool called <a href="https://github.com/perusio/nginx-cache-purge" target="_blank">nginx-cache-purge</a>.</p>
<p>The usage is: </p>
<pre><code>nginx-cache-purge "foobar.cs" /var/www/cache/nginx/baz
</code></pre>
<p>So that I can add a invoking line in my "<code>edit</code>" action inside my doc controller:</p>
     <div class="source" style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: rgb(246, 243, 232); background-color: rgb(36, 36, 36);"><span style="color: rgb(246, 243, 232);">system</span>(<span style="color: rgb(149, 228, 84); font-style: italic;">"nginx-cache-purge 'doc' /var/www/cache"</span>)<br></div>
<br>
<p>Now every time we edit the Counter by HTTP POST, the Rails app will invoke CLI to purge the "/doc" cache, so that next request will lead nginx to re-cache it, we are all set!</p>
<p><strong>Fantastic</strong>! </p>
<p>Actually nginx provide a standard HTTP API to purge the cache, that is <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_cache_bypass">proxy_cache_bypass</a> module, it allows website administrators to define customized interface to bypass nginx cache look up, in my nginx.conf above there are two lines:
  </p><pre><code>proxy_cache_bypass   $http_secret_header;
add_header X-Cache-Status $upstream_cache_status;
    </code></pre>
<p></p>
<p>So if any client fires a HTTP request that contains header <code>Secret-Header: 1</code>, nginx will bypass the request regardless of whether the requested resource was cached or not.</p>
<img src="https://pgkdga.bn1.livefilestore.com/y1pt9XpGn0edu-3msOBOWb2rPJObHacsUaWgZqqOs9QCXQxXe__pCDlDv8XYiJXRVHkrQzkUTL1YwPBC5W_G6H2bNrPWfMB0AkN/Screen%20Shot%202013-01-10%20at%204.14.33%20PM.png?psid=1" alt="Bypass cache">

<h2>Conclusion</h2>
<p>nginx is really a powerful and fast web server, and it is easy to use and config as well! Using nginx as a Cache Reverse Proxy can dramatically improve your website's loading speed and concurrency performance, thus improves UX and lower down the server cost. That's why it is <a href="http://www.nginx.com/company.html#nginx-users" target="_blank">used by so many popular websites</a>.</p>
<h2>References</h2>
<p class="p1"><span class="s1"><a href="https://github.com/FRiCKLE/ngx_cache_purge/">https://github.com/FRiCKLE/ngx_cache_purge/</a></span><span class="s2">&nbsp;A nginx purge model</span></p>
<p class="p1"><span class="s1"><a href="http://serverfault.com/questions/30705/how-to-set-up-nginx-as-a-caching-reverse-proxy">http://serverfault.com/questions/30705/how-to-set-up-nginx-as-a-caching-reverse-proxy</a></span></p>
<p class="p1"><span class="s1"><a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html">http://nginx.org/en/docs/http/ngx_http_proxy_module.html</a></span></p>
<p class="p1"><span class="s1"><a href="http://wiki.nginx.org/HttpProxyModule">http://wiki.nginx.org/HttpProxyModule</a></span></p>
<p class="p1"><span class="s1"><a href="https://github.com/perusio/nginx-cache-purge">https://github.com/perusio/nginx-cache-purge</a></span><span class="s2">&nbsp;</span></p>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#hack" class="page__taxonomy-item" rel="tag">Hack</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#hack" class="page__taxonomy-item" rel="tag">Hack</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2013-01-10T00:00:00-08:00">January 10, 2013</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Cache+Reverse+Proxy+-+nginx%20http%3A%2F%2Flocalhost%3A4000%2FCache-Reverse-Proxy-nginx" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2FCache-Reverse-Proxy-nginx" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2FCache-Reverse-Proxy-nginx" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/12-Tips-To-Boost-RSpec-And-Cucumber" class="pagination--pager" title="12 tips to boost RSpect and Cucumber
">Previous</a>
    
    
      <a href="/Cache-Reverse-Proxy-Varnish" class="pagination--pager" title="Cache Reverse Proxy - Varnish
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Master-AWS-Development-Video-Published" rel="permalink">Master AWS Development Video Published
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Publishing information

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Passing-AWS-Certified-Solutions-Architect" rel="permalink">Passing AWS Certified Solutions Architect
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">
3 years of AWS hands on experience, two months of preparation, 30 hours of course learning, 300+ exam practices, this was the work I've done to pass the&nbs...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/self-improvement/passing-aws-certified-solutions-architect/" rel="permalink">Passing AWS Certified Solutions Architect
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/geek/Storage-Media-Home-Server-Less-Than-300/" rel="permalink">Storage+Media home server for less than $300
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Background
I have been researched and watched many NAS options to setup a home storage+media server during the past year, and so far there was no perfect ans...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="mailto:admin@wayneye.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
        
      
        
          <li><a href="https://wayneye.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Website</a></li>
        
      
        
          <li><a href="https://twitter.com/wayneye" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://facebook.com/WayneYeDotCom" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
        
      
        
          <li><a href="https://github.com/WayneYe/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Wayne Ye. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.1/js/all.js" integrity="sha384-g5uSoOSBd7KkhAMlnQILrecXvzst9TdC09/VM+pjDTCM+1il8RHz5fKANTFFb+gQ" crossorigin="anonymous"></script>







    <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5&appId=374223339969060";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
  





  </body>
</html>
